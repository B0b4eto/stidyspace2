<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <title>Skyline Flashcards Studio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body {
            background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
        }

        /* Glassmorphism ефект от Figma */
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .card-stage {
            perspective: 1500px;
            width: 480px;
            height: 300px;
        }

        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            transform-style: preserve-3d;
        }

        .card-inner.flipped {
            transform: rotateY(180deg);
        }

        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 32px;
            padding: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .back {
            transform: rotateY(180deg);
            background: rgba(10, 10, 10, 0.9);
            border: 1px solid rgba(168, 85, 247, 0.3);
        }

        .ai-glow {
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.4);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.2); }
            50% { box-shadow: 0 0 40px rgba(168, 85, 247, 0.5); }
            100% { box-shadow: 0 0 20px rgba(168, 85, 247, 0.2); }
        }

        textarea {
            background: transparent;
            border: none;
            outline: none;
            resize: none;
            width: 100%;
            text-align: center;
        }
    </style>
</head>
<body>

    <div class="fixed top-8 px-6 py-2 glass rounded-full flex items-center gap-3 text-sm font-medium tracking-wide border-white/5">
        <div class="w-2 h-2 bg-purple-500 rounded-full animate-pulse"></div>
        Skyline Hub
    </div>

    <div class="card-stage">
        <div class="card-inner" id="cardElement">
            <div class="face front glass">
                <div class="text-[10px] uppercase tracking-[0.3em] text-purple-400 font-bold">Concept</div>
                <textarea id="question" class="text-2xl font-light h-32 flex items-center" placeholder="Напиши тема..."></textarea>
                <button onclick="askAI(event)" id="aiBtn" class="w-full py-4 rounded-2xl bg-white text-black font-bold text-sm hover:bg-gray-200 transition-all transform active:scale-95">
                    Generate Answer
                </button>
            </div>

            <div class="face back">
                <div class="text-[10px] uppercase tracking-[0.3em] text-green-400 font-bold">AI Insight</div>
                <textarea id="answer" class="text-lg text-gray-200 h-32 font-medium" readonly></textarea>
                <div class="flex gap-2">
                    <button onclick="flipBack()" class="flex-1 py-3 rounded-xl border border-white/10 text-xs font-bold hover:bg-white/5 transition-all">Flip</button>
                    <button onclick="saveCard(event)" class="flex-1 py-3 rounded-xl bg-purple-600 text-white text-xs font-bold hover:bg-purple-500 transition-all">Save to Deck</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Инициализация
        const sb = window.supabase.createClient("https://zfqpfhtbpfdudbpqzbbg.supabase.co", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmcXBmaHRicGZkdWRicHF6YmJnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyOTQ5NzQsImV4cCI6MjA4Mzg3MDk3NH0.QnmNeFn9LX9ZIc-bINH_4DNKFeJj9LCYU7QF5ZwfaDE");
        
        async function askAI(e) {
            const btn = document.getElementById('aiBtn');
            const prompt = document.getElementById('question').value;
            if(!prompt) return;

            btn.innerText = "Consulting AI...";
            btn.classList.add('ai-glow');

            try {
                const response = await fetch("https://curly-mountain-4c28.boy05geo.workers.dev", {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ prompt: prompt })
                });
                const data = await response.json();
                
                document.getElementById('answer').value = data.answer;
                document.getElementById('cardElement').classList.add('flipped');
            } catch (err) {
                alert("Error connecting to AI.");
            } finally {
                btn.innerText = "Generate Answer";
                btn.classList.remove('ai-glow');
            }
        }

        function flipBack() {
            document.getElementById('cardElement').classList.remove('flipped');
        }

        async function saveCard(e) {
            const q = document.getElementById('question').value;
            const a = document.getElementById('answer').value;
            const { error } = await sb.from('cards').insert([{ front: q, back: a }]);
            if(!error) alert("Saved to your collection!");
        }
    </script>
</body>
</html>
