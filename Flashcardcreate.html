<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <title>Skyline Studio | Official Aesthetic</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@200;400;600;800&display=swap');

        /* [1] HOMEPAGE VIBE - СВЕТЪЛ И ЧИСТ ФОН */
        body {
            background: radial-gradient(at top left, #ffffff 0%, #f0f4f8 50%, #e2e8f0 100%);
            font-family: 'Plus Jakarta Sans', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            color: #0f172a;
            margin: 0;
            overflow-x: hidden;
        }

        /* [2] ОГРОМНАТА БЯЛА КАРТА (THE CANVAS) */
        .main-card {
            background: #ffffff;
            border-radius: 50px;
            box-shadow: 0 50px 100px -20px rgba(0,0,0,0.04), 0 30px 60px -15px rgba(0,0,0,0.02);
            width: 880px;
            height: 520px;
            position: relative;
            transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-style: preserve-3d;
            border: 1px solid rgba(255,255,255,0.8);
        }

        .flipped { transform: rotateY(180deg); }
        .face { position: absolute; inset: 0; backface-visibility: hidden; border-radius: 50px; padding: 70px; display: flex; flex-direction: column; }
        .back { transform: rotateY(180deg); background: #fafafa; border: 1px solid #f0f0f0; }

        /* [3] СЛАЙДЪР С КАРТИ (GLASS STYLE) */
        .slider-wrapper {
            width: 100%;
            max-width: 1200px;
            margin-top: 60px;
            padding: 0 40px 100px 40px;
        }

        .slider-container {
            display: flex;
            gap: 20px;
            overflow-x: auto;
            padding: 20px 0;
            scroll-behavior: smooth;
            scrollbar-width: none; /* Firefox */
            scroll-snap-type: x mandatory;
        }

        .slider-container::-webkit-scrollbar { display: none; } /* Chrome/Safari */

        .mini-card {
            flex: 0 0 300px;
            height: 180px;
            background: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0,0,0,0.03);
            border-radius: 32px;
            padding: 30px;
            scroll-snap-align: start;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .mini-card:hover {
            background: #ffffff;
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.03);
        }

        /* СТИЛОВЕ ЗА ТЕКСТА */
        textarea {
            font-weight: 800;
            color: #0f172a;
            letter-spacing: -2px;
            line-height: 1.1;
        }

        .btn-primary {
            background: #000000;
            color: white;
            border-radius: 24px;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>

    <nav class="w-full max-w-7xl px-12 py-10 flex justify-between items-center">
        <div class="flex items-center gap-2">
            <div class="w-3 h-3 bg-black rounded-full"></div>
            <span class="text-xl font-extrabold tracking-tighter">Skyline Studio</span>
        </div>
        <div class="flex gap-10 text-xs font-bold uppercase tracking-widest text-gray-400">
            <a href="#" class="text-black">Create</a>
            <a href="#" class="hover:text-black transition">Collection</a>
            <a href="#" class="hover:text-black transition">Settings</a>
        </div>
    </nav>

    <main class="mt-10 flex flex-col items-center">
        <div class="main-card" id="cardElement">
            <div class="face front">
                <div class="flex justify-between items-center mb-12">
                    <span class="text-[10px] font-black uppercase tracking-[0.4em] text-blue-500">New Insight</span>
                    <i data-lucide="sparkles" class="w-5 h-5 text-gray-200"></i>
                </div>
                <textarea id="q-in" class="text-6xl bg-transparent border-none outline-none resize-none flex-1 placeholder-gray-100" placeholder="Type a concept..."></textarea>
                <button onclick="runAI()" id="run-btn" class="btn-primary w-full py-6 text-xl">
                    Analyze Node
                </button>
            </div>

            <div class="face back">
                <div class="flex justify-between items-center mb-12">
                    <span class="text-[10px] font-black uppercase tracking-[0.4em] text-green-500">Synthesized Data</span>
                    <button onclick="flipBack()" class="p-2 hover:bg-gray-100 rounded-full transition"><i data-lucide="x" class="w-5 h-5 text-gray-300"></i></button>
                </div>
                <textarea id="a-out" class="text-2xl font-semibold bg-transparent border-none outline-none resize-none flex-1 text-gray-600" readonly></textarea>
                <button onclick="saveCard()" class="w-full py-6 bg-blue-600 text-white rounded-[24px] font-bold text-lg">Save to Library</button>
            </div>
        </div>

        <div class="slider-wrapper">
            <div class="flex justify-between items-end mb-8 px-2">
                <div>
                    <h2 class="text-3xl font-extrabold tracking-tighter">Library</h2>
                    <p class="text-gray-400 text-sm">Your recent knowledge nodes</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="moveSlider(-320)" class="p-4 rounded-full bg-white border border-gray-100 hover:bg-gray-50 transition shadow-sm"><i data-lucide="arrow-left" class="w-5 h-5"></i></button>
                    <button onclick="moveSlider(320)" class="p-4 rounded-full bg-white border border-gray-100 hover:bg-gray-50 transition shadow-sm"><i data-lucide="arrow-right" class="w-5 h-5"></i></button>
                </div>
            </div>
            
            <div class="slider-container" id="deck-grid">
                </div>
        </div>
    </main>

    <script>
        const S_URL = "https://zfqpfhtbpfdudbpqzbbg.supabase.co";
        const S_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmcXBmaHRicGZkdWRicHF6YmJnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyOTQ5NzQsImV4cCI6MjA4Mzg3MDk3NH0.QnmNeFn9LX9ZIc-bINH_4DNKFeJj9LCYU7QF5ZwfaDE";
        const sb = window.supabase.createClient(S_URL, S_KEY);
        const WORKER = "https://curly-mountain-4c28.boy05geo.workers.dev";

        lucide.createIcons();
        loadDeck();

        function moveSlider(distance) {
            document.getElementById('deck-grid').scrollBy({ left: distance, behavior: 'smooth' });
        }

        async function runAI() {
            const q = document.getElementById('q-in').value;
            if(!q) return;
            const btn = document.getElementById('run-btn');
            btn.innerText = "Processing...";
            const res = await fetch(WORKER, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({ prompt: q }) });
            const data = await res.json();
            document.getElementById('a-out').value = data.answer;
            document.getElementById('cardElement').classList.add('flipped');
            btn.innerText = "Analyze Node";
        }

        function flipBack() { document.getElementById('cardElement').classList.remove('flipped'); }

        async function saveCard() {
            const f = document.getElementById('q-in').value;
            const b = document.getElementById('a-out').value;
            await sb.from('cards').insert([{ front: f, back: b }]);
            loadDeck();
            flipBack();
        }

        async function loadDeck() {
            const { data } = await sb.from('cards').select('*').order('created_at', { ascending: false });
            const grid = document.getElementById('deck-grid');
            grid.innerHTML = data.map(c => `
                <div class="mini-card">
                    <div class="w-10 h-10 bg-black/5 rounded-2xl flex items-center justify-center">
                        <i data-lucide="book-open" class="w-5 h-5 text-black"></i>
                    </div>
                    <div class="text-sm font-bold text-gray-800 line-clamp-3">${c.front}</div>
                    <div class="text-[9px] font-black uppercase tracking-widest text-gray-300">Vaulted</div>
                </div>
            `).join('');
            lucide.createIcons();
        }
    </script>
</body>
</html>
